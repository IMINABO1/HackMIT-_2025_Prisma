<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Tandem API</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .test-button { background: #007cba; color: white; border: none; padding: 10px 20px; margin: 5px; border-radius: 5px; cursor: pointer; }
    .test-button:hover { background: #005a82; }
    #output { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; white-space: pre-wrap; }
    .error { background: #ffebee; color: #c62828; }
    .success { background: #e8f5e8; color: #2e7d32; }
  </style>
</head>
<body>
  <h1>Test Tandem API Direct</h1>
  
  <button class="test-button" onclick="testTandemAPI()">Test Tandem API</button>
  <button class="test-button" onclick="clearOutput()">Clear Output</button>
  
  <div id="output">Click "Test Tandem API" to test the connection...</div>

  <script>
    const API_KEY = "gk-iAwShEtD_133shfqz2cp"; // Your Tandem API key
    
    function log(message, isError = false) {
      const output = document.getElementById('output');
      const timestamp = new Date().toLocaleTimeString();
      output.textContent += `[${timestamp}] ${message}\n`;
      
      if (isError) {
        output.className = 'error';
      } else {
        output.className = 'success';
      }
    }
    
    function clearOutput() {
      const output = document.getElementById('output');
      output.textContent = 'Output cleared...\n';
      output.className = '';
    }
    
    async function testTandemAPI() {
      log('Testing Tandem API connection...');
      
      try {
        const requestBody = {
          model: "deepseek-chat",
          messages: [{ 
            role: "user", 
            content: "Give a brief technical hint about debugging JavaScript errors. One sentence only." 
          }],
          max_tokens: 50,
          temperature: 0.7
        };
        
        log('Making request to: https://api.tandem.run/v1/chat/completions');
        log('Request body: ' + JSON.stringify(requestBody, null, 2));
        
        const response = await fetch("https://api.tandem.run/v1/chat/completions", {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${API_KEY}`,
            "Content-Type": "application/json"
          },
          body: JSON.stringify(requestBody)
        });
        
        log(`Response status: ${response.status} ${response.statusText}`);
        log('Response headers: ' + JSON.stringify(Object.fromEntries(response.headers.entries()), null, 2));
        
        if (!response.ok) {
          const errorText = await response.text();
          log(`ERROR: ${errorText}`, true);
          return;
        }
        
        const result = await response.json();
        log('SUCCESS! Response: ' + JSON.stringify(result, null, 2));
        
        if (result.choices && result.choices[0] && result.choices[0].message) {
          log(`AI Response: "${result.choices[0].message.content}"`);
        } else {
          log('ERROR: Unexpected response format', true);
        }
        
      } catch (error) {
        log(`ERROR: ${error.message}`, true);
        console.error('Full error:', error);
      }
    }
  </script>
</body>
</html>
